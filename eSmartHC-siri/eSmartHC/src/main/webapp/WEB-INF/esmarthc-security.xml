<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/security"
	xmlns:beans="http://www.springframework.org/schema/beans" 
	xmlns:context="http://www.springframework.org/schema/context"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans    
	http://www.springframework.org/schema/beans/spring-beans-3.2.xsd
	http://www.springframework.org/schema/context
http://www.springframework.org/schema/context/spring-context.xsd   
	 http://www.springframework.org/schema/security        
	  http://www.springframework.org/schema/security/spring-security-3.2.xsd">
  
   
  <debug/> 
  <!-- <http auto-config="true"> -->
   <http auto-config="true" use-expressions="true">
     <!-- <http-basic/> -->
     <form-login login-page="/getLoginPage"
       default-target-url="/secure/getAllUserProcessInfo"
        authentication-failure-url="/home"
     />
     <intercept-url pattern="/secure/*" access="isAuthenticated()"/>
     <logout logout-success-url="/home" delete-cookies="JSESSIONID"/> 
   </http>
   
   <global-method-security pre-post-annotations="enabled">
     <expression-handler ref="methodExpression"/>
   </global-method-security>
   
   <beans:bean id="methodExpression" class="org.springframework.security.access.expression.method.DefaultMethodSecurityExpressionHandler">
     <beans:property name="permissionEvaluator" ref="esmartPermissionEvaluator"></beans:property>
     
   </beans:bean>
   

<!-- <beans:bean id="myAuthProvider" class="com.siri.esmartHealthCare.config.EsamrtAuthProvider"></beans:bean> -->
<authentication-manager>
  <authentication-provider ref="esamrtAuthProvider">
     <!-- <user-service>
       <user name="john" password="john" authorities="ROLE_ADMIN"/>
       <user name="jack" password="jack" authorities="ROLE_USER" />
     </user-service> -->
  
  </authentication-provider>
</authentication-manager>
</beans:beans>
 